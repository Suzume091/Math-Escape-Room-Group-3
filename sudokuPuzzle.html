<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>9x9 Sudoku + Problems Linked</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&family=Nosifer&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Creepster', cursive;
    display: flex;
    justify-content: center;
    gap: 50px;
    margin-top: 40px;
    background:#000;
    color:#eee;
  }
  table { border-collapse: collapse; }
  td {
    width: 45px; height: 45px;
    text-align: center;
    border: 2px solid #550000;
    font-size: 18px;
  }
  td.quad-right { border-right: 4px solid #8B0000; }
  td.quad-bottom { border-bottom: 4px solid #8B0000; }
  input {
    width: 90%; height: 90%;
    text-align: center;
    font-size: 18px;
    border: none;
    background: #111;
    color: #eee;
  }
  input::placeholder { color: #555; font-style: italic; }
  input:focus { outline: 2px solid red; }

  /* Shake animation */
  .shake { animation: shake 0.4s; }
  @keyframes shake {
    25%{transform:translateX(-5px);} 
    50%{transform:translateX(5px);}
    75%{transform:translateX(-5px);} 
    100%{transform:translateX(0);}
  }

  .problems-table {
    border-collapse: collapse;
    width: 350px;
  }
  .problems-table td {
    border: 1px solid #550000;
    padding: 6px;
    font-size: 16px;
  }
  .problems-table input { width: 50px; text-align: center; }

  .bloody-btn {
    margin-top: 20px;
    padding: 12px 22px;
    border-radius: 10px;
    background: linear-gradient(180deg,#550000 0%, #120000 100%);
    border: 2px solid #8b0000;
    color:#fff;
    font-size:18px;
    cursor:pointer;
    display:none;
  }
</style>
</head>
<body>

<!-- Sudoku LEFT -->
<div>
  <table id="sudoku"></table>
  <button class="bloody-btn" id="proceedBtn" onclick="window.location.href ='sudokuFinal.html'">PROCEED</button>
</div>

<!-- Problems RIGHT -->
<div>
  <h2>Problems</h2>
  <table class="problems-table" id="problems"></table>
</div>

<script>
// =================== 9x9 SUDOKU ===================
const solution = [
  [5,3,4, 6,7,8, 9,1,2],
  [6,7,2, 1,9,5, 3,4,8],
  [1,9,8, 3,4,2, 5,6,7],

  [8,5,9, 7,6,1, 4,2,3],
  [4,2,6, 8,5,3, 7,9,1],
  [7,1,3, 9,2,4, 8,5,6],

  [9,6,1, 5,3,7, 2,8,4],
  [2,8,7, 4,1,9, 6,3,5],
  [3,4,5, 2,8,6, 1,7,9]
];

// Problems and answers
const problems = [
  {q:"a₁=5, a₅=25, find d", ans:5, letter:"A"},
  {q:"a₁=7, a₉=31, find d", ans:3, letter:"B"},
  {q:"a₁=2, a₄=16, find r", ans:2, letter:"C"},
  {q:"a₁=8, a₇=26, find d", ans:3, letter:"D"},
  {q:"a₁=5, a₅=3125, find r", ans:5, letter:"E"},
  {q:"a₁=7, a₉=47, find d", ans:5, letter:"F"},
  {q:"a₁=6, a₁₂=50, find d", ans:4, letter:"G"},
  {q:"a₁=2, a₄=54, find r", ans:3, letter:"H"},
  {q:"a₁=1, a₅=6561, find r", ans:9, letter:"I"}
];

// Map letters to answers
const letterToAnswer = {};
problems.forEach(p => { letterToAnswer[p.letter] = p.ans; });

// Fixed blanks, each tied to one problem letter
let blanks = {
  "0-0":"A","0-1":"B","1-2":"C",
  "2-3":"D","3-1":"E","4-4":"F",
  "5-5":"G","7-7":"H","8-8":"I"
};

const table = document.getElementById("sudoku");
for (let i=0;i<9;i++){
  let tr=document.createElement("tr");
  for (let j=0;j<9;j++){
    let td=document.createElement("td");
    if ((j+1)%3===0 && j!==8) td.classList.add("quad-right");
    if ((i+1)%3===0 && i!==8) td.classList.add("quad-bottom");

    let key=i+"-"+j;
    if (blanks[key]){
      let input=document.createElement("input");
      input.placeholder=blanks[key];
      input.maxLength=1;
      input.dataset.row=i; 
      input.dataset.col=j;
      input.dataset.letter=blanks[key];
      input.addEventListener("input",(e)=>{
        let expected = letterToAnswer[e.target.dataset.letter];
        if(parseInt(e.target.value)===expected){
          e.target.value=expected;
          e.target.disabled=true; // lock it
          checkCompletion();
        } else {
          e.target.classList.add("shake");
          setTimeout(()=>e.target.classList.remove("shake"),400);
          e.target.value="";
        }
      });
      td.appendChild(input);
    } else {
      td.textContent=solution[i][j];
    }
    tr.appendChild(td);
  }
  table.appendChild(tr);
}

// Sudoku complete check
function sudokuComplete(){
  const inputs=document.querySelectorAll("#sudoku input");
  for (let inp of inputs){
    if(!inp.disabled) return false; // still unsolved
  }
  return true;
}

// =================== PROBLEMS TABLE ===================
const probs=document.getElementById("problems");
problems.forEach((p)=>{
  let tr=document.createElement("tr");
  let tdQ=document.createElement("td"); tdQ.textContent=p.q;
  let tdA=document.createElement("td");
  let inp=document.createElement("input");
  inp.maxLength=2;
  inp.placeholder=p.letter; // show linked letter
  inp.addEventListener("change",(e)=>{
    if(parseInt(e.target.value)===p.ans){
      tdA.textContent=p.ans;
      // also auto-fill Sudoku
      const sudokuInput=document.querySelector(`#sudoku input[placeholder='${p.letter}']`);
      if(sudokuInput){
        sudokuInput.value=p.ans;
        sudokuInput.disabled=true;
      }
      checkCompletion();
    } else {
      e.target.classList.add("shake");
      setTimeout(()=>e.target.classList.remove("shake"),400);
      e.target.value="";
    }
  });
  tdA.appendChild(inp);
  tr.appendChild(tdQ); tr.appendChild(tdA);
  probs.appendChild(tr);
});

function problemsComplete(){
  return [...probs.querySelectorAll("td:nth-child(2)")].every(td => td.textContent.trim()!="" && !td.querySelector("input"));
}

// Check all complete
function checkCompletion(){
  if (sudokuComplete() && problemsComplete()){
    document.getElementById("proceedBtn").style.display="block";
  }
}
</script>

</body>
</html>